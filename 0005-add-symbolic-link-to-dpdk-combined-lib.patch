From b18008c32822f0c369afc4e6b051fa5046125975 Mon Sep 17 00:00:00 2001
From: Mario Carrillo <mario.alfredo.c.arevalo@intel.com>
Date: Mon, 7 Mar 2016 11:48:32 -0600
Subject: [PATCH] mk: add symbolic link to dpdk combined lib

In order to have the dpdk files in the correct
packages, it's necessary to add a symbolic link
to dpdk combined library, otherwise the dpdk lib will be
installed in a wrong package.

Signed-off-by: Mario Carrillo <mario.alfredo.c.arevalo@intel.com>
---
 mk/rte.sharelib.mk | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/mk/rte.sharelib.mk b/mk/rte.sharelib.mk
index 70c49a8..be01244 100644
--- a/mk/rte.sharelib.mk
+++ b/mk/rte.sharelib.mk
@@ -33,6 +33,7 @@ include $(RTE_SDK)/mk/internal/rte.build-pre.mk
 
 # VPATH contains at least SRCDIR
 VPATH += $(SRCDIR)
+EXT := 2.2
 
 ifeq ($(CONFIG_RTE_BUILD_COMBINE_LIBS),y)
 ifeq ($(CONFIG_RTE_BUILD_SHARED_LIB),y)
@@ -54,10 +55,10 @@ ifeq ($(LINK_USING_CC),1)
 LD := $(CC) $(CPU_CFLAGS)
 O_TO_S = $(LD) $(call linkerprefix,$(CPU_LDFLAGS)) \
 	 $(call linkerprefix,$(COMBINED_LDFLAGS)) \
-	-shared $(OBJS) -o $(RTE_OUTPUT)/lib/$(LIB_ONE)
+	-shared $(OBJS) -o $(RTE_OUTPUT)/lib/$(LIB_ONE).$(EXT)
 else
 O_TO_S = $(LD) $(CPU_LDFLAGS) $(COMBINED_LDFLAGS) \
-	-shared $(OBJS) -o $(RTE_OUTPUT)/lib/$(LIB_ONE)
+	-shared $(OBJS) -o $(RTE_OUTPUT)/lib/$(LIB_ONE).$(EXT)
 endif
 
 O_TO_S_STR = $(subst ','\'',$(O_TO_S)) #'# fix syntax highlight
@@ -83,6 +84,7 @@ ifeq ($(CONFIG_RTE_BUILD_SHARED_LIB),y)
 $(LIB_ONE): FORCE
 	@[ -d $(dir $@) ] || mkdir -p $(dir $@)
 	@$(SRCDIR)/scripts/merge-maps.sh > $(COMBINED_MAP)
+	@ln -s -f $(LIB_ONE).$(EXT) $(RTE_OUTPUT)/lib/$(LIB_ONE)
 	$(O_TO_S_DO)
 else
 $(LIB_ONE): FORCE
-- 
2.6.4.442.g545299f.dirty

